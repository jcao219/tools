Command
=======

Commands available to the `cs3110` executable.
Each has some documentation inside the `.ml` file, and the command-line interface has summaries and readmes.

All the interfaces are as sparse as possible.

Clean
-----
Removes files generated by other commands.
Most output is stored under the folder named `_cs3110`, but compiler output is in the `_build` directory and custom output could be anywhere.

CMS
---
Converts a spreadsheet (probably generated by the harness, but it could be anything) into a spreadsheet ready for upload to CMS.
Overall, this is pretty simple.
CMS expects a NetID column, columns for each assignment part, and a column to "Add Comments".
(The "Totals" column is optional. If you leave it out, CMS computes the total.)

This command just scrapes the important (as set by the user) columns from the original sheet, saves NetIDs, and scrapes comments from an external directory.

Compile
-------
Simple wrapper for `ocamlbuild`.
Searches for a modules dependencies and compiles a bytecode executable.

Additional compiler options can be set using the config file `./.cs3110`.

Diff
----
Tool for comparing students' current and past submissions.
Given a list of current submissions, searches a directory of old submissions for any matches and if so outputs a diff.
Diffs are not generated if the old fle is empty (did not originally submit) or the new and old files match.

The original use-case is to implement no-compile grace period.
If the assignment deadline was Thursday, we'd compile submissions using `cs3110 smoke` that night, and send emails soon afterward to students whose submissions did not compile.
Students could then resubmit by Sunday to avoid getting a zero on the assignment.

If the difference between new and old files was big, they'd lose a slip day.
If not, no penalty.
Hence the need for a tool to compare submissions on a large scale.

Doc
---
Simple wrapper for `ocamldoc`.
Given a list of `.ml` or `.mli` files, attempts to create their documentation using the compiler output in the `_build` directory.

Email
-----
Used to send lots and lots of emails.
With great power comes great responsibility.

Searches a directory for email message files that look like `<netid>.txt` and sends their contents to the address `<netid>@cornell.edu`.
You can optionally name admins (the professor, yourself) to be included as hidden recipients (bcc's) of the email messages.

Harness
-------
Tool for running the tests contained in one or more test files on a list of submission directories.
Output is saved in a grades table, in CMS-ready markdown and, optionally, postscript.
(The grades table is global, the markdown is per-student, the postscript is per test file per student.)

Note: a "test" or "test file" is an OCaml module containing some inline tests.
A "unit test" is one of those inline tests.

Test files are copied into students' directories, then compiled and run using `cs3110 compile` and `cs3110 test`, respectively.
Test output is saved into two intermediate files -- one containing unit test names and one containing failure messages.
We scrape these to build the final results for each student.

Run
---
Umm, `cs3110 run file args` is literally `./_build/file.d.byte args`.
I suppose this could change in the future, but for now the command is really simple.

Smoke
-----
Tool for checking that students' submissions compile.
Given a list of directories and the names of files to compile, tries to compile each file in each directory.

If a students files don't compile, we save an email message and a copy of the submission for that student.

Test
----
Use `cs3110 test file` to run the inline tests within a file.
This is essentially a wrapper for `./_build/file.d.byte inline-test-runner target`, but there are conveniences for making and saving output.

